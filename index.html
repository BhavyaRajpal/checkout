<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; padding: 20px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0px 0px 10px gray; }
        input, select, button { width: 100%; padding: 10px; margin-top: 10px; border-radius: 5px; border: 1px solid #ddd; }
        button { background: blue; color: white; border: none; cursor: pointer; }
        button:disabled { background: gray; cursor: not-allowed; }
        .hidden { display: none; }
        .error { color: red; margin-top: 10px; }
        .success { color: green; margin-top: 10px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Checkout</h2>
    <select id="paymentMethod" name="paymentMethod" onchange="togglePaymentFields()">
        <option value="card">Card</option>
        <option value="upi">UPI</option>
        <option value="cod">Cash on Delivery</option>
    </select>

    <input type="text" id="upiId" name="upiId" placeholder="Enter UPI ID" class="hidden">

    <button id="payNow" onclick="startPayment()">Pay Now</button>
    <p id="orderMessage" class="success"></p>
    <p id="errorMessage" class="error"></p>
</div>

<script>
    function togglePaymentFields() {
        let paymentMethod = document.getElementById("paymentMethod").value;
        let upiField = document.getElementById("upiId");
        upiField.style.display = (paymentMethod === "upi") ? "block" : "none";
    }

    function startPayment() {
        let amount = 999 * 100;  // Amount in paisa
        fetch("http://127.0.0.1:5000/create-order", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ amount: amount })
        })
        .then(response => response.json())
        .then(order => {
            let options = {
                key: "YOUR_RAZORPAY_KEY",
                amount: order.amount,
                currency: order.currency,
                order_id: order.id,
                name: "Your Business Name",
                description: "Order Payment",
                handler: function (response) {
                    alert("Payment Successful! Payment ID: " + response.razorpay_payment_id);
                }
            };
            let rzp1 = new Razorpay(options);
            rzp1.open();
        })
        .catch(error => {
            document.getElementById("errorMessage").textContent = "Error initiating payment.";
        });
    }
</script>
</body>
</html>
